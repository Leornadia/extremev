"use strict";(()=>{var e={};e.id=9684,e.ids=[9684,9313],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},43934:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>C,patchFetch:()=>P,requestAsyncStorage:()=>b,routeModule:()=>f,serverHooks:()=>R,staticGenerationAsyncStorage:()=>v});var r={};a.r(r),a.d(r,{GET:()=>w,dynamic:()=>g});var i=a(49303),s=a(88716),n=a(60670),c=a(87070),d=a(29313);class o{set(e,t,a={}){let r=a.ttl||3e5;this.cache.set(e,{data:t,timestamp:Date.now(),ttl:r,tags:a.tags||[]}),this.cache.size>this.maxSize&&this.cleanup()}get(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}has(e){return null!==this.get(e)}delete(e){this.cache.delete(e)}clear(){this.cache.clear()}invalidateByTag(e){for(let[t,a]of this.cache.entries())a.tags.includes(e)&&this.cache.delete(t)}invalidateByPattern(e){let t=new RegExp(e);for(let e of this.cache.keys())t.test(e)&&this.cache.delete(e)}cleanup(){let e=Array.from(this.cache.entries());e.sort((e,t)=>e[1].timestamp-t[1].timestamp);let t=Math.floor(.2*this.maxSize);for(let a=0;a<t;a++)this.cache.delete(e[a][0])}getStats(){return{size:this.cache.size,maxSize:this.maxSize,entries:Array.from(this.cache.entries()).map(([e,t])=>({key:e,age:Date.now()-t.timestamp,ttl:t.ttl,tags:t.tags}))}}constructor(){this.cache=new Map,this.maxSize=1e3}}class l{async connect(){if(!this.connected)try{this.connected=!0,console.log("Redis cache connected")}catch(e){console.error("Failed to connect to Redis:",e),this.connected=!1}}async set(e,t,a={}){if(this.connected)try{if(a.ttl,JSON.stringify({data:t,timestamp:Date.now(),tags:a.tags||[]}),a.tags)for(let e of a.tags);}catch(e){console.error("Redis set error:",e)}}async get(e){if(!this.connected)return null;try{return null}catch(e){return console.error("Redis get error:",e),null}}async delete(e){this.connected}async invalidateByTag(e){this.connected}async clear(){this.connected}constructor(){this.client=null,this.connected=!1}}class u{constructor(){this.memoryCache=new o,this.redisCache=new l,this.useRedis=void 0!==process.env.REDIS_URL,this.useRedis&&this.redisCache.connect()}async set(e,t,a={}){this.memoryCache.set(e,t,a),this.useRedis&&await this.redisCache.set(e,t,a)}async get(e){let t=this.memoryCache.get(e);if(null!==t)return t;if(this.useRedis){let t=await this.redisCache.get(e);if(null!==t)return this.memoryCache.set(e,t),t}return null}async delete(e){this.memoryCache.delete(e),this.useRedis&&await this.redisCache.delete(e)}async invalidateByTag(e){this.memoryCache.invalidateByTag(e),this.useRedis&&await this.redisCache.invalidateByTag(e)}invalidateByPattern(e){this.memoryCache.invalidateByPattern(e)}async clear(){this.memoryCache.clear(),this.useRedis&&await this.redisCache.clear()}getStats(){return{memory:this.memoryCache.getStats(),redis:this.useRedis?"connected":"not configured"}}}let h=new u;async function p(e,t,a={}){let r=await h.get(e);if(null!==r)return a.staleWhileRevalidate&&t().then(t=>{h.set(e,t,a)}).catch(e=>{console.error("Background revalidation failed:",e)}),r;let i=await t();return await h.set(e,i,a),i}let m={products:e=>`products:${e||"all"}`},g="force-dynamic",y=[{id:"1",name:"Adventure Playground Set",slug:"adventure-playground-set",description:"Complete playground set with slides, swings, and climbing features",basePrice:15e3,images:["/images/Large%20Double-Tower%20Wooden%20Jungle%20Gym%20with%20Blue%20Slide.webp"],published:!0,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15"),tierId:"premium",tier:{id:"premium",name:"Premium",description:"High-end playground equipment",basePrice:15e3,features:["Premium materials","Extended warranty"],materials:["Cedar wood","Stainless steel"],warranty:"10 years",ageRange:"3-12 years",capacity:15,dimensions:{width:20,depth:15,height:12,unit:"ft"},createdAt:new Date,updatedAt:new Date}},{id:"2",name:"Classic Jungle Gym",slug:"classic-jungle-gym",description:"Traditional jungle gym with monkey bars and climbing frame",basePrice:8500,images:["/images/Red%20Wooden%20Playset%20with%20Yellow%20Slide%20and%20Sandpit.webp"],published:!0,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-10"),tierId:"standard",tier:{id:"standard",name:"Standard",description:"Quality playground equipment for everyday fun",basePrice:8500,features:["Durable construction","5-year warranty"],materials:["Treated pine","Galvanized steel"],warranty:"5 years",ageRange:"3-10 years",capacity:10,dimensions:{width:15,depth:12,height:10,unit:"ft"},createdAt:new Date,updatedAt:new Date}},{id:"3",name:"Compact Play Structure",slug:"compact-play-structure",description:"Space-saving playground perfect for smaller yards",basePrice:5500,images:["/images/Wooden%20Jungle%20Gym%20with%20Green%20Slide%20in%20a%20Garden.webp"],published:!0,createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-05"),tierId:"basic",tier:{id:"basic",name:"Basic",description:"Affordable playground solutions",basePrice:5500,features:["Easy assembly","3-year warranty"],materials:["Treated pine","Powder-coated steel"],warranty:"3 years",ageRange:"2-8 years",capacity:6,dimensions:{width:10,depth:8,height:8,unit:"ft"},createdAt:new Date,updatedAt:new Date}}];async function w(e){try{let t;let a=e.nextUrl.searchParams,r=a.get("tier"),i=a.get("sort")||"newest",s=parseInt(a.get("page")||"1",10),n=parseInt(a.get("pageSize")||"12",10);try{let e={published:!0};r&&(e.tierId=r);let a=m.products(`tier=${r||"all"}&sort=${i}`);t=await p(a,()=>(0,d.Xp)(e),{ttl:3e5,staleWhileRevalidate:6e5,tags:["products"]})}catch(e){console.warn("Database not available, using mock data:",e),t=y.filter(e=>!r||e.tierId===r)}let o=[...t];switch(i){case"price-asc":o.sort((e,t)=>e.basePrice-t.basePrice);break;case"price-desc":o.sort((e,t)=>t.basePrice-e.basePrice);break;case"name":o.sort((e,t)=>e.name.localeCompare(t.name));break;default:o.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())}let l=o.length,u=(s-1)*n,h=o.slice(u,u+n);return c.NextResponse.json({data:h,pagination:{page:s,pageSize:n,total:l,totalPages:Math.ceil(l/n)}},{headers:function(e){let{maxAge:t=60,staleWhileRevalidate:a=300,public:r=!0}=e;return{"Cache-Control":`${r?"public":"private"}, max-age=${t}, stale-while-revalidate=${a}`}}({maxAge:60,staleWhileRevalidate:300,public:!0})})}catch(e){return console.error("Error fetching products:",e),c.NextResponse.json({error:{code:"INTERNAL_ERROR",message:"Failed to fetch products",timestamp:new Date().toISOString()}},{status:500})}}let f=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"/Users/almeidajose/Documents/A/App/Extreme V/app/api/products/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:b,staticGenerationAsyncStorage:v,serverHooks:R}=f,C="/api/products/route";function P(){return(0,n.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:v})}},29313:(e,t,a)=>{a.d(t,{Co:()=>n,Xp:()=>s,eJ:()=>i,getComponents:()=>c,getComponentsByCategory:()=>d});var r=a(72331);async function i(e){return r.Z.productTier.findMany({where:{published:!0,...e},orderBy:{order:"asc"}})}async function s(e){return r.Z.product.findMany({where:{published:!0,...e},include:{tier:!0},orderBy:{createdAt:"desc"}})}async function n(e){return r.Z.product.findUnique({where:{slug:e},include:{tier:!0}})}async function c(e){return r.Z.component.findMany({where:{published:!0,...e},include:{tier:!0},orderBy:[{category:"asc"},{name:"asc"}]})}async function d(e){return r.Z.component.findMany({where:{category:e,published:!0},include:{tier:!0},orderBy:{name:"asc"}})}},72331:(e,t,a)=>{a.d(t,{Z:()=>c,_:()=>n});var r=a(53524);let i=global,s=null;try{s=i.prisma||new r.PrismaClient({log:["error"]})}catch(e){console.warn("Prisma client initialization failed:",e),s=null}let n=s,c=n}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5972],()=>a(43934));module.exports=r})();