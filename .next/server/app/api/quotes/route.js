"use strict";(()=>{var e={};e.id=505,e.ids=[505],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},6005:e=>{e.exports=require("node:crypto")},24338:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>L,patchFetch:()=>S,requestAsyncStorage:()=>A,routeModule:()=>k,serverHooks:()=>_,staticGenerationAsyncStorage:()=>T});var s={};n.r(s),n.d(s,{GET:()=>q,POST:()=>x});var o=n(49303),a=n(88716),i=n(60670),r=n(87070),c=n(75571),d=n(90455),l=n(72331);class p{registerErrorRule(e){this.errorRules.set(e.id,e)}registerWarningRule(e){this.warningRules.set(e.id,e)}getErrorRules(){return Array.from(this.errorRules.values()).filter(e=>e.enabled)}getWarningRules(){return Array.from(this.warningRules.values()).filter(e=>e.enabled)}getRule(e){return this.errorRules.get(e)||this.warningRules.get(e)}setRuleEnabled(e,t){let n=this.getRule(e);n&&(n.enabled=t)}getRulesByCategory(e){return[...this.getErrorRules(),...this.getWarningRules()].filter(t=>t.category===e)}constructor(){this.errorRules=new Map,this.warningRules=new Map}}class u{constructor(e){this.registry=e}evaluate(e){let t=[],n=[];for(let n of this.registry.getErrorRules()){let s=n.check(e);s.passed||t.push({id:`${n.id}-${Date.now()}`,type:this.mapRuleToErrorType(n),message:s.message||n.description,affectedComponents:s.affectedComponents,suggestion:s.suggestion})}for(let t of this.registry.getWarningRules()){let s=t.check(e);s.passed||n.push({id:`${t.id}-${Date.now()}`,type:this.mapRuleToWarningType(t),message:s.message||t.description,affectedComponents:s.affectedComponents,suggestion:s.suggestion})}return{errors:t,warnings:n}}evaluateCategory(e,t){let n=[],s=[];for(let o of this.registry.getRulesByCategory(t)){let t=o.check(e);t.passed||("error"===o.type?n.push({id:`${o.id}-${Date.now()}`,type:this.mapRuleToErrorType(o),message:t.message||o.description,affectedComponents:t.affectedComponents,suggestion:t.suggestion}):s.push({id:`${o.id}-${Date.now()}`,type:this.mapRuleToWarningType(o),message:t.message||o.description,affectedComponents:t.affectedComponents,suggestion:t.suggestion}))}return{errors:n,warnings:s}}mapRuleToErrorType(e){if(e.id.startsWith("structural"));else if(e.id.startsWith("safety"))return"safety_compliance";else if(e.id.startsWith("compatibility"))return"compatibility";else if(e.id.includes("connection"))return"connection_invalid";else if(e.id.includes("height"))return"height_exceeded";else if(e.id.includes("capacity"))return"capacity_exceeded";else if(e.id.includes("access"))return"missing_access";else if(e.id.includes("disconnected"))return"disconnected_component";return"structural_integrity"}mapRuleToWarningType(e){return e.id.includes("material")?"material_mismatch":e.id.includes("age")?"age_range_mismatch":e.id.includes("recommended")?"recommended_component_missing":"suboptimal_layout"}}function m(e){return e.customizations?.options?._componentData||null}function g(e){return e.components.map(e=>{let t=m(e);return t?{placed:e,data:t}:null}).filter(e=>null!==e)}function f(e,t){return e.components.filter(e=>{let n=m(e);return n?.category===t})}let h=[{id:"structural-all-connected",name:"All Components Connected",description:"All components must be connected to form a single structure",type:"error",category:"structural",enabled:!0,check:e=>{if(0===e.components.length||1===e.components.length)return{passed:!0,affectedComponents:[]};let t=function(e){let t=new Map;return e.components.forEach(e=>{t.set(e.instanceId,new Set)}),e.components.forEach(e=>{e.connections.forEach(e=>{let n=t.get(e.fromInstanceId),s=t.get(e.toInstanceId);n&&n.add(e.toInstanceId),s&&s.add(e.fromInstanceId)})}),t}(e),n=function(e,t){let n=new Set,s=[e];for(;s.length>0;){let e=s.shift();if(n.has(e))continue;n.add(e);let o=t.get(e);o&&o.forEach(e=>{n.has(e)||s.push(e)})}return n}(e.components[0].instanceId,t),s=e.components.filter(e=>!n.has(e.instanceId)).map(e=>e.instanceId);return s.length>0?{passed:!1,affectedComponents:s,message:`${s.length} component(s) are not connected to the main structure`,suggestion:"Connect all components using structural connectors or remove disconnected components"}:{passed:!0,affectedComponents:[]}}},{id:"structural-deck-access",name:"Deck Access Required",description:"All elevated decks must have at least one access point",type:"error",category:"structural",enabled:!0,check:e=>{let t=f(e,"playdecks");if(0===t.length)return{passed:!0,affectedComponents:[]};let n=[];for(let s of t)m(s)&&!(s.position.z<2)&&(s.connections.some(t=>{let n=e.components.find(e=>e.instanceId===t.toInstanceId||e.instanceId===t.fromInstanceId);if(!n)return!1;let s=m(n);return s?.category==="access"})||n.push(s.instanceId));return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} elevated deck(s) have no access point`,suggestion:"Add a ladder, stairs, or climbing wall to each elevated deck"}:{passed:!0,affectedComponents:[]}}},{id:"structural-height-limit",name:"Height Restriction",description:"Structures must not exceed 12 feet in height",type:"error",category:"structural",enabled:!0,check:e=>{let t=g(e),n=[];for(let{placed:e,data:s}of t)e.position.z+s.dimensions.height>12&&n.push(e.instanceId);return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) exceed the maximum height of 12 feet`,suggestion:"Lower components or remove them to stay within the 12 foot height limit"}:{passed:!0,affectedComponents:[]}}},{id:"structural-weight-limit",name:"Weight Distribution",description:"Total structure weight must not exceed 5000 lbs",type:"error",category:"structural",enabled:!0,check:e=>{let t=e.metadata.estimatedWeight;return t>5e3?{passed:!1,affectedComponents:e.components.map(e=>e.instanceId),message:`Total structure weight (${t} lbs) exceeds maximum limit of 5000 lbs`,suggestion:"Remove some components or choose lighter alternatives to reduce total weight"}:{passed:!0,affectedComponents:[]}}},{id:"structural-support-required",name:"Structural Support",description:"Elevated components must have proper structural support",type:"error",category:"structural",enabled:!0,check:e=>{let t=g(e),n=[];for(let{placed:s,data:o}of t){if(s.position.z<1||"connectors"===o.category)continue;let t=s.connections.some(t=>{let n=e.components.find(e=>e.instanceId===t.toInstanceId||e.instanceId===t.fromInstanceId);if(!n)return!1;let s=m(n);return s?.category==="connectors"||s?.category==="playdecks"});"playdecks"!==o.category&&"roofs"!==o.category||t||0!==s.connections.length||n.push(s.instanceId)}return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} elevated component(s) lack proper structural support`,suggestion:"Connect components to structural supports or lower them to ground level"}:{passed:!0,affectedComponents:[]}}},{id:"structural-minimum-components",name:"Minimum Components",description:"Design must include at least one playdeck as foundation",type:"error",category:"structural",enabled:!0,check:e=>0===e.components.length?{passed:!1,affectedComponents:[],message:"Design is empty - add components to begin",suggestion:"Start by adding a playdeck as the foundation"}:0===f(e,"playdecks").length?{passed:!1,affectedComponents:e.components.map(e=>e.instanceId),message:"Design must include at least one playdeck",suggestion:"Add a playdeck to serve as the foundation of your structure"}:{passed:!0,affectedComponents:[]}}],y={preschool:{min:2,max:5,maxHeight:6},schoolAge:{min:5,max:12,maxHeight:12}},C=[{id:"safety-minimum-spacing",name:"Minimum Spacing",description:"Components must be at least 1.5 feet apart",type:"error",category:"safety",enabled:!0,check:e=>{let t=g(e),n=[];for(let e=0;e<t.length;e++)for(let s=e+1;s<t.length;s++){let o=t[e],a=t[s],i=o.placed.position.x-a.placed.position.x,r=o.placed.position.y-a.placed.position.y;Math.sqrt(i*i+r*r)<(o.data.dimensions.width+a.data.dimensions.width)/2+1.5&&(n.includes(o.placed.instanceId)||n.push(o.placed.instanceId),n.includes(a.placed.instanceId)||n.push(a.placed.instanceId))}return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) are too close together`,suggestion:"Maintain at least 1.5 feet of spacing between components for safety"}:{passed:!0,affectedComponents:[]}}},{id:"safety-fall-zone",name:"Fall Zone Clearance",description:"Adequate fall zones must be maintained around elevated components",type:"error",category:"safety",enabled:!0,check:e=>{let t=g(e),n=[];for(let{placed:e,data:s}of t){let o=e.position.z+s.dimensions.height;if(o<2)continue;let a=Math.max(1.5*o,6);for(let{placed:o,data:i}of t){if(e.instanceId===o.instanceId)continue;let t=e.position.x-o.position.x,r=e.position.y-o.position.y;Math.sqrt(t*t+r*r)-(s.dimensions.width+i.dimensions.width)/2<a&&!n.includes(e.instanceId)&&n.push(e.instanceId)}}return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) have insufficient fall zone clearance`,suggestion:"Increase spacing around elevated components to meet fall zone requirements"}:{passed:!0,affectedComponents:[]}}},{id:"safety-age-appropriate",name:"Age-Appropriate Design",description:"All components must be appropriate for the target age range",type:"error",category:"safety",enabled:!0,check:e=>{let t=g(e);if(0===t.length)return{passed:!0,affectedComponents:[]};let n=e.metadata.ageRange,s=[];for(let{placed:e,data:o}of t){let t=o.metadata.ageRange;if(t&&t!==n){let t=e.position.z+o.dimensions.height;n.includes("2-5")&&t>y.preschool.maxHeight?s.push(e.instanceId):n.includes("5-12")&&t>y.schoolAge.maxHeight&&s.push(e.instanceId)}}return s.length>0?{passed:!1,affectedComponents:s,message:`${s.length} component(s) may not be age-appropriate`,suggestion:"Review component heights and features for the target age range"}:{passed:!0,affectedComponents:[]}}},{id:"safety-capacity-limit",name:"Capacity Limit",description:"Design must not exceed safe capacity limits",type:"error",category:"safety",enabled:!0,check:e=>{let t=e.metadata.capacity,n=Math.floor(e.metadata.dimensions.width*e.metadata.dimensions.depth*2);return t>n?{passed:!1,affectedComponents:e.components.map(e=>e.instanceId),message:`Design capacity (${t} children) exceeds safe limit of ${n} for the structure size`,suggestion:"Reduce the number of high-capacity components or increase the structure size"}:{passed:!0,affectedComponents:[]}}},{id:"safety-slide-exit",name:"Slide Exit Clearance",description:"Slides must have adequate exit clearance",type:"error",category:"safety",enabled:!0,check:e=>{let t=f(e,"slides");if(0===t.length)return{passed:!0,affectedComponents:[]};let n=[];for(let s of t){let t=m(s);if(!t)continue;let o=s.position.x+t.dimensions.depth,a=s.position.y,i=!0;for(let t of e.components){if(t.instanceId===s.instanceId||!m(t))continue;let e=Math.abs(o-t.position.x),n=Math.abs(a-t.position.y);if(6>Math.sqrt(e*e+n*n)){i=!1;break}}i||n.push(s.instanceId)}return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} slide(s) lack adequate exit clearance`,suggestion:"Ensure 6 feet of clearance at slide exits"}:{passed:!0,affectedComponents:[]}}},{id:"safety-swing-clearance",name:"Swing Clearance",description:"Swings must have adequate clearance in all directions",type:"error",category:"safety",enabled:!0,check:e=>{let t=f(e,"swings");if(0===t.length)return{passed:!0,affectedComponents:[]};let n=[];for(let s of t){let t=m(s);if(!t)continue;let o=!0;for(let n of e.components){if(n.instanceId===s.instanceId)continue;let e=m(n);if(!e)continue;let a=s.position.x-n.position.x,i=s.position.y-n.position.y;if(Math.sqrt(a*a+i*i)<(t.dimensions.width+e.dimensions.width)/2+8){o=!1;break}}o||n.push(s.instanceId)}return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} swing(s) lack adequate clearance`,suggestion:"Ensure 8 feet of clearance around all swings"}:{passed:!0,affectedComponents:[]}}}],I=[{id:"compatibility-connection-points",name:"Connection Point Matching",description:"Connections must be made between compatible connection points",type:"error",category:"compatibility",enabled:!0,check:e=>{let t=[];for(let n of e.components){let s=m(n);if(s)for(let o of n.connections){let a=e.components.find(e=>e.instanceId===o.toInstanceId||e.instanceId===o.fromInstanceId);if(!a){t.push(n.instanceId);continue}let i=m(a);if(!i)continue;let r=s.connectionPoints.find(e=>e.id===o.fromConnectionPointId),c=i.connectionPoints.find(e=>e.id===o.toConnectionPointId);if(!r||!c){t.push(n.instanceId);continue}!function(e,t){let n={deck:["deck","structural","slide","accessory"],slide:["deck","structural"],swing:["structural","roof"],structural:["deck","slide","swing","roof","structural"],roof:["deck","structural","swing"],accessory:["deck","structural"]};return n[e]?.includes(t)||n[t]?.includes(e)}(r.type,c.type)&&t.push(n.instanceId),r.allowedConnections.includes(i.id)||r.allowedConnections.includes(i.category)||r.allowedConnections.includes("*")||t.push(n.instanceId)}}let n=Array.from(new Set(t));return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) have invalid connections`,suggestion:"Ensure connections are made between compatible connection points"}:{passed:!0,affectedComponents:[]}}},{id:"compatibility-component-size",name:"Component Size Compatibility",description:"Connected components must have compatible sizes",type:"error",category:"compatibility",enabled:!0,check:e=>{let t=[];for(let n of e.components){let s=m(n);if(s)for(let o of n.connections){let a=e.components.find(e=>e.instanceId===o.toInstanceId||e.instanceId===o.fromInstanceId);if(!a)continue;let i=m(a);i&&("deck"===o.connectionType?Math.abs(s.dimensions.width-i.dimensions.width)>2&&t.push(n.instanceId):"slide"===o.connectionType&&"playdecks"===s.category&&Math.abs(s.dimensions.width-i.dimensions.width)>1&&t.push(n.instanceId))}}let n=Array.from(new Set(t));return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) have size compatibility issues`,suggestion:"Connect components with similar sizes or use adapter components"}:{passed:!0,affectedComponents:[]}}},{id:"compatibility-rules-enforcement",name:"Compatibility Rules Enforcement",description:"Component compatibility rules must be satisfied",type:"error",category:"compatibility",enabled:!0,check:e=>{let t=[];for(let n of e.components){let s=m(n);if(s)for(let o of s.compatibilityRules)"requires"===o.ruleType?e.components.some(e=>{let t=m(e);return t&&o.targetComponentIds.some(e=>e===t.id||e===t.category)})||t.push(n.instanceId):"excludes"===o.ruleType&&e.components.some(e=>{let t=m(e);return t&&o.targetComponentIds.some(e=>e===t.id||e===t.category)})&&t.push(n.instanceId)}let n=Array.from(new Set(t));return n.length>0?{passed:!1,affectedComponents:n,message:`${n.length} component(s) violate compatibility rules`,suggestion:"Review component requirements and exclusions to resolve conflicts"}:{passed:!0,affectedComponents:[]}}}],w=[{id:"compatibility-material-tier",name:"Material Compatibility",description:"Components should be from compatible product tiers",type:"warning",category:"compatibility",enabled:!0,check:e=>{let t=g(e);if(0===t.length)return{passed:!0,affectedComponents:[]};let n=new Set;return(t.forEach(({data:e})=>{e.metadata.tier&&n.add(e.metadata.tier)}),n.size>1)?{passed:!1,affectedComponents:t.filter(({data:e})=>e.metadata.tier).map(({placed:e})=>e.instanceId),message:`Design mixes components from ${n.size} different product tiers: ${Array.from(n).join(", ")}`,suggestion:"Consider using components from the same tier for consistent quality and aesthetics"}:{passed:!0,affectedComponents:[]}}},{id:"compatibility-color-coordination",name:"Color Coordination",description:"Component colors should coordinate well",type:"warning",category:"compatibility",enabled:!0,check:e=>{let t=g(e);if(t.length<2)return{passed:!0,affectedComponents:[]};let n=new Set;return(t.forEach(({data:e})=>{e.metadata.colors.forEach(e=>n.add(e))}),n.size>4)?{passed:!1,affectedComponents:e.components.map(e=>e.instanceId),message:`Design uses ${n.size} different colors, which may look busy`,suggestion:"Consider limiting to 2-3 coordinating colors for a cohesive look"}:{passed:!0,affectedComponents:[]}}},{id:"compatibility-recommended-components",name:"Recommended Components",description:"Recommended components for this design",type:"warning",category:"compatibility",enabled:!0,check:e=>{let t=[];for(let n of e.components){let s=m(n);if(s)for(let o of s.compatibilityRules)"recommends"===o.ruleType&&!e.components.some(e=>{let t=m(e);return t&&o.targetComponentIds.some(e=>e===t.id||e===t.category)})&&o.message&&t.push(n.instanceId)}let n=Array.from(new Set(t));return n.length>0?{passed:!1,affectedComponents:n,message:"Some recommended components are missing from your design",suggestion:"Consider adding recommended components to enhance the play experience"}:{passed:!0,affectedComponents:[]}}}],b=new p;h.forEach(e=>{b.registerErrorRule(e)}),C.forEach(e=>{b.registerErrorRule(e)}),[{id:"safety-surfacing-recommended",name:"Safety Surfacing Recommended",description:"Safety surfacing is recommended for this design",type:"warning",category:"safety",enabled:!0,check:e=>e.metadata.dimensions.height>2?{passed:!1,affectedComponents:[],message:"Safety surfacing (rubber mulch, wood chips, or safety mats) is recommended for structures over 2 feet high",suggestion:"Consider adding safety surfacing to reduce injury risk from falls"}:{passed:!0,affectedComponents:[]}}].forEach(e=>{b.registerWarningRule(e)}),I.forEach(e=>{b.registerErrorRule(e)}),w.forEach(e=>{b.registerWarningRule(e)});let R=new u(b);var v=n(932);let E=new Map;async function x(e){try{let t=function(e){let t=e.headers.get("x-forwarded-for"),n=t?t.split(",")[0]:"unknown";return`quote_${n}`}(e);if(!function(e){let t=Date.now(),n=E.get(e);return!n||t>n.resetTime?(E.set(e,{count:1,resetTime:t+36e5}),{allowed:!0,remaining:2}):n.count>=3?{allowed:!1,remaining:0}:(n.count+=1,{allowed:!0,remaining:3-n.count})}(t).allowed)return r.NextResponse.json({error:{code:"RATE_LIMIT_EXCEEDED",message:"Too many quote requests. Please try again later."}},{status:429});let s=await (0,c.getServerSession)(d.L),o=await e.json(),a=function(e){let t=[];if(e.design&&"object"==typeof e.design){let n=e.design;n.components&&Array.isArray(n.components)?0===n.components.length&&t.push("Design must have at least one component"):t.push("Design must contain components")}else t.push("Design data is required");if(e.customerInfo&&"object"==typeof e.customerInfo){let n=e.customerInfo;(!n.name||"string"!=typeof n.name||n.name.trim().length<2)&&t.push("Valid name is required"),n.email&&"string"==typeof n.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||t.push("Invalid email format"):t.push("Email is required"),n.phone&&"string"==typeof n.phone||t.push("Phone number is required"),n.city&&"string"==typeof n.city&&0!==n.city.trim().length||t.push("City is required"),n.state&&"string"==typeof n.state&&0!==n.state.trim().length||t.push("State/Province is required"),n.postalCode&&"string"==typeof n.postalCode&&0!==n.postalCode.trim().length||t.push("Postal code is required")}else t.push("Customer information is required");return t.length>0?{valid:!1,errors:t}:{valid:!0,data:e}}(o);if(!a.valid)return r.NextResponse.json({error:{code:"VALIDATION_ERROR",message:"Invalid quote request data",details:a.errors}},{status:400});let{design:i,customerInfo:p,includeInstallation:u=!1}=a.data,m=R.evaluate(i);if(m.errors.length>0)return r.NextResponse.json({error:{code:"INVALID_DESIGN",message:"Design has validation errors",details:m.errors.map(e=>e.message)}},{status:400});let g={city:p.city,state:p.state,postalCode:p.postalCode},f=(0,v.vL)(i,g,u),h=(0,v.z2)(f);if(!h.isValid)return r.NextResponse.json({error:{code:"PRICING_ERROR",message:"Failed to calculate pricing",details:h.errors}},{status:400});let y=await l._.quoteRequest.create({data:{userId:s?.user?.id||null,designSnapshot:i,customerInfo:p,pricing:f,status:"pending"}});return Promise.all([n.e(2723),n.e(5612)]).then(n.bind(n,85612)).then(({sendQuoteRequestEmails:e})=>{e({quoteId:y.id,customerInfo:p,design:i,pricing:f,createdAt:y.createdAt}).catch(e=>{console.error("Failed to send quote emails:",e)})}).catch(e=>{console.error("Failed to import email service:",e)}),r.NextResponse.json({success:!0,quoteRequest:{id:y.id,status:y.status,createdAt:y.createdAt},pricing:f},{status:201})}catch(e){return console.error("Quote request error:",e),r.NextResponse.json({error:{code:"INTERNAL_ERROR",message:"Failed to process quote request. Please try again later."}},{status:500})}}async function q(e){try{let t=await (0,c.getServerSession)(d.L);if(!t?.user?.id)return r.NextResponse.json({error:{code:"UNAUTHORIZED",message:"Authentication required"}},{status:401});let{searchParams:n}=new URL(e.url),s=n.get("status"),o=parseInt(n.get("limit")||"10",10),a=parseInt(n.get("offset")||"0",10),i={userId:t.user.id};s&&(i.status=s);let[p,u]=await Promise.all([l._.quoteRequest.findMany({where:i,orderBy:{createdAt:"desc"},take:o,skip:a}),l._.quoteRequest.count({where:i})]);return r.NextResponse.json({quoteRequests:p,pagination:{total:u,limit:o,offset:a,hasMore:a+o<u}},{status:200})}catch(e){return console.error("Get quote requests error:",e),r.NextResponse.json({error:{code:"INTERNAL_ERROR",message:"Failed to fetch quote requests"}},{status:500})}}let k=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/quotes/route",pathname:"/api/quotes",filename:"route",bundlePath:"app/api/quotes/route"},resolvedPagePath:"/Users/almeidajose/Documents/A/App/Extreme V/app/api/quotes/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:A,staticGenerationAsyncStorage:T,serverHooks:_}=k,L="/api/quotes/route";function S(){return(0,i.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:T})}},90455:(e,t,n)=>{n.d(t,{L:()=>l});var s=n(53797),o=n(77234),a=n(24459),i=n(13539),r=n(72331),c=n(98691);let d=[{id:"1",email:"demo@extremev.co.za",name:"Demo User",passwordHash:"$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/hL/.LG7my"},{id:"2",email:"admin@extremev.co.za",name:"Admin User",passwordHash:"$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/hL/.LG7my"}],l={adapter:process.env.DATABASE_URL?.includes("localhost")?void 0:(0,i.N)(r._),providers:[(0,s.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Invalid credentials");try{if(process.env.DATABASE_URL&&!process.env.DATABASE_URL.includes("localhost")){let t=await r._.user.findUnique({where:{email:e.email}});if(!t||!t.passwordHash||!await c.ZP.compare(e.password,t.passwordHash))throw Error("Invalid credentials");return{id:t.id,email:t.email,name:t.name}}}catch(e){console.warn("Database not available, using mock authentication")}let t=d.find(t=>t.email===e.email);if(!t||!await c.ZP.compare(e.password,t.passwordHash))throw Error("Invalid credentials");return{id:t.id,email:t.email,name:t.name}}}),...process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&"your-google-client-id"!==process.env.GOOGLE_CLIENT_ID?[(0,o.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,allowDangerousEmailAccountLinking:!0})]:[],...process.env.FACEBOOK_CLIENT_ID&&process.env.FACEBOOK_CLIENT_SECRET&&"your-facebook-app-id"!==process.env.FACEBOOK_CLIENT_ID?[(0,a.Z)({clientId:process.env.FACEBOOK_CLIENT_ID,clientSecret:process.env.FACEBOOK_CLIENT_SECRET,allowDangerousEmailAccountLinking:!0})]:[]],session:{strategy:"jwt",maxAge:2592e3},pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error"},callbacks:{signIn:async({user:e,account:t,profile:n})=>!0,jwt:async({token:e,user:t,account:n,profile:s})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id),e)},secret:process.env.NEXTAUTH_SECRET,debug:!1}},932:(e,t,n)=>{function s(e,t,n=!1){let{components:s,subtotal:o}=function(e){let t=new Map;e.components.forEach(e=>{let n=e.customizations?.options?._componentData;if(!n){console.warn(`Component data not found for instance ${e.instanceId}`);return}let s=t.get(n.id);s?(s.quantity+=1,s.totalPrice=s.quantity*s.unitPrice):t.set(n.id,{componentId:n.id,name:n.name,quantity:1,unitPrice:n.price,totalPrice:n.price})});let n=Array.from(t.values()),s=n.reduce((e,t)=>e+t.totalPrice,0);return{components:n,subtotal:s}}(e),a=function(e,t){let n=function(e){let t=e.city.toLowerCase();return["johannesburg","pretoria","cape town","durban","port elizabeth","bloemfontein"].some(e=>t.includes(e))?200:800}(t),s=Math.round(2*e.metadata.estimatedWeight);return{baseRate:500,distanceRate:n,weightRate:s,total:Math.round(500+n+s)}}(e,t),i=n?function(e){let t=300*e.metadata.componentCount,n=function(e){let t=1;e.metadata.dimensions.height>10?t+=.2:e.metadata.dimensions.height>8&&(t+=.1);let n=e.metadata.dimensions.width*e.metadata.dimensions.depth;return n>200?t+=.2:n>150&&(t+=.1),e.metadata.componentCount>15?t+=.2:e.metadata.componentCount>10&&(t+=.1),Math.round(100*t)/100}(e);return{baseRate:2e3,componentRate:t,complexityMultiplier:n,total:Math.round((2e3+t)*n)}}(e):void 0,r=o+a.total+(i?.total||0);return{components:s,subtotal:o,shipping:a,installation:i,total:r}}function o(e,t="ZAR"){return"ZAR"===t?`R ${e.toLocaleString("en-ZA")}`:`${t} ${e.toLocaleString()}`}function a(e){let t=[];return 0===e.components.length&&t.push("No components in design"),e.subtotal<=0&&t.push("Invalid subtotal"),e.shipping.total<0&&t.push("Invalid shipping cost"),e.total<=0&&t.push("Invalid total price"),{isValid:0===t.length,errors:t}}n.d(t,{T4:()=>o,vL:()=>s,z2:()=>a})},72331:(e,t,n)=>{n.d(t,{Z:()=>r,_:()=>i});var s=n(53524);let o=global,a=null;try{a=o.prisma||new s.PrismaClient({log:["error"]})}catch(e){console.warn("Prisma client initialization failed:",e),a=null}let i=a,r=i}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),s=t.X(0,[8948,5972,8691,5177],()=>n(24338));module.exports=s})();